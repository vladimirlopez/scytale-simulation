(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function a(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(t){if(t.ep)return;t.ep=!0;const o=a(t);fetch(t.href,o)}})();const s={message:"",faces:4,mode:"encode",rotation:0},u=document.getElementById("cylinder"),B=document.getElementById("message-input"),S=document.getElementById("diameter-slider"),b=document.getElementById("diameter-value"),T=document.getElementById("result-output"),E=document.getElementById("mode-encode"),y=document.getElementById("mode-decode"),w=document.getElementById("btn-learn"),A=document.getElementById("modal-learn"),O=document.getElementById("btn-challenge"),M=document.getElementById("modal-challenge"),N=document.querySelectorAll(".close-modal");function _(){k(),p(),i()}function k(){w.addEventListener("click",()=>A.classList.remove("hidden")),O.addEventListener("click",()=>M.classList.remove("hidden")),N.forEach(t=>t.addEventListener("click",o=>{o.target.closest(".modal").classList.add("hidden")})),B.addEventListener("input",t=>{s.message=t.target.value,i()}),S.addEventListener("input",t=>{s.faces=parseInt(t.target.value),b.textContent=s.faces,p(),i()}),E.addEventListener("click",()=>g("encode")),y.addEventListener("click",()=>g("decode"));let n=!1,e=0,a=0;const c=document.querySelector(".scytale-container");c.addEventListener("mousedown",t=>{n=!0,e=t.clientX,a=s.rotation,c.style.cursor="grabbing"}),window.addEventListener("mousemove",t=>{if(!n)return;const o=t.clientX-e;s.rotation=a+o*.5,L()}),window.addEventListener("mouseup",()=>{n=!1,c.style.cursor="grab"}),document.getElementById("btn-submit-challenge").addEventListener("click",I),document.getElementById("btn-download-cert").addEventListener("click",$)}function g(n){s.mode=n,E.classList.toggle("active",n==="encode"),y.classList.toggle("active",n==="decode"),i()}const h=50;function p(){u.innerHTML="";const n=s.faces,e=360/n,a=h/2/Math.tan(Math.PI/n);for(let c=0;c<n;c++){const t=document.createElement("div");t.className="face",t.style.width=`${h}px`,t.style.transform=`rotateY(${c*e}deg) translateZ(${a}px)`,t.id=`face-${c}`,u.appendChild(t)}}function L(){u.style.transform=`rotateY(${s.rotation}deg)`}function i(){const n=s.message.replace(/[\r\n]+/g,""),e=s.faces;let a="";if(document.querySelectorAll(".face").forEach(c=>c.innerHTML=""),s.mode==="encode"){for(let c=0;c<n.length;c++){const t=c%e,o=n[c];f(t,o)}for(let c=0;c<e;c++){const t=R(c);a+=t}}else{for(let l=0;l<n.length;l++){const r=l%e,d=n[l];f(r,d)}Math.ceil(n.length/e);let c=0;for(let l=0;l<e;l++){const r=Math.floor(n.length/e),d=n.length%e,x=l<d||d===0?r+(d===0?0:1):r;for(let m=0;m<x;m++)c<n.length&&(f(l,n[c]),c++)}let t="";const o=Math.ceil(n.length/e);for(let l=0;l<o;l++)for(let r=0;r<e;r++){const d=document.getElementById(`face-${r}`);d&&d.children[l]&&(t+=d.children[l].textContent)}a=t}T.textContent=a,I(!1)}function f(n,e){const a=document.getElementById(`face-${n}`),c=document.createElement("div");c.className="face-letter",c.textContent=e,a.appendChild(c)}function R(n,e,a){const c=document.getElementById(`face-${n}`);return Array.from(c.children).map(t=>t.textContent).join("")}const D="STESOCA__OYLICL",v=3,C="SCYTALE_IS_COOL";document.querySelector(".challenge-code").textContent=D;document.getElementById("challenge-hint-faces").textContent=v;function I(n){document.getElementById("challenge-input").value.trim().toUpperCase().replace(/\s/g,"_"),n&&isEvent}document.getElementById("btn-submit-challenge").onclick=()=>{document.getElementById("challenge-input").value.toUpperCase().replace(/\s/g,"_")===C?document.getElementById("challenge-success").classList.remove("hidden"):alert("Incorrect! Try setting the rod faces to "+v+" and decoding.")};function $(){const n=document.createElement("canvas");n.width=800,n.height=600;const e=n.getContext("2d");e.fillStyle="#0f1115",e.fillRect(0,0,800,600),e.strokeStyle="#d4af37",e.lineWidth=10,e.strokeRect(20,20,760,560),e.font="40px Cinzel",e.fillStyle="#d4af37",e.textAlign="center",e.fillText("CERTIFICATE OF MASTERY",400,100),e.font="20px Outfit",e.fillStyle="#e0e0e0",e.fillText("This certifies that the student has successfully",400,200),e.fillText("cracked the Spartan Scytale Cipher.",400,240),e.font="30px Courier New",e.fillStyle="#fff",e.fillText(C,400,350),e.font="16px Outfit",e.fillStyle="#aaa",e.fillText("Date: "+new Date().toLocaleDateString(),400,500);const a=document.createElement("a");a.download="scytale_certificate.png",a.href=n.toDataURL(),a.click()}L();_();
