<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Interactive Scytale Cipher Simulation for learning cryptography.">
  <title>Scytale Cipher | Intro to Cryptography</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Outfit:wght@300;400;600&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="./style.css">
</head>

<body>
  <div id="app">
    <header>
      <div class="logo">
        <h1>SCYTALE <span class="accent">CIPHER</span></h1>
      </div>
      <nav>
        <button id="btn-learn" class="nav-btn">How it Works</button>
        <button id="btn-challenge" class="nav-btn special">Challenge Mode</button>
      </nav>
    </header>

    <main>
      <div class="controls-panel card">
        <div class="input-group">
          <label for="message-input">MESSAGE</label>
          <textarea id="message-input" placeholder="Enter your secret message here..."></textarea>
        </div>

        <div class="settings-group">
          <div class="setting">
            <label for="diameter-input">ROD FACES (DIAMETER)</label>
            <div class="slider-container">
              <input type="range" id="diameter-slider" min="2" max="12" value="4">
              <span id="diameter-value">4</span>
            </div>
          </div>

          <div class="setting toggles">
            <label>OPERATION</label>
            <div class="toggle-switch">
              <button id="mode-encode" class="active">Encode</button>
              <button id="mode-decode">Decode</button>
            </div>
          </div>
        </div>
      </div>

      <div class="visualization-panel">

        <div class="scene-3d">
          <div class="rod-instructions">
            <span class="icon">↺</span> Drag to Rotate Rod
          </div>
          <div class="scytale-wrapper" id="scytale-wrapper">
            <div id="cylinder" class="cylinder">
              <!-- Faces generated by JS -->
            </div>
            <div class="cylinder-end left"></div>
            <div class="cylinder-end right"></div>
          </div>
        </div>

        <div class="strip-view-container">
          <label>THE UNWRAPPED STRIP (CIPHERTEXT)</label>
          <div class="strip-track">
            <div id="strip-content" class="parchment-strip">
              <!-- Strip letters go here -->
            </div>
          </div>
        </div>

        <!-- 2D Grid View (Flattened) -->
        <div class="grid-view-container" style="margin-top: 20px;">
          <label>ROD VIEW (READ HORIZONTALLY →)</label>
          <div id="grid-content" class="grid-content">
            <!-- Grid Rows -->
          </div>
        </div>

        <!-- Decoded Message Display -->
        <div class="decoded-message-container" style="margin-top: 20px;">
          <label>DECODED MESSAGE</label>
          <div id="decoded-message" class="decoded-message"></div>
        </div>

      </div>
    </main>

    <!-- Modals -->
    <div id="modal-learn" class="modal hidden">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>The Spartan Scytale</h2>
        <p>
          The scytale (rhymes with "Italy") is a transposition cipher used by ancient Spartans.
        </p>
        <h3>How it Works</h3>
        <p>
          <strong>Top View (Rod):</strong> You wrap a long strip of parchment around a rod. You write your message
          <em>lengthwise</em> along the rod (across the wrapped turns).
        </p>
        <p>
          <strong>Bottom View (Strip):</strong> When you unwind the strip, the letters are scrambled. This is what the
          messenger carries.
        </p>
        <p>
          <strong>To Decode:</strong> The receiver must have a rod of the <em>exact same diameter</em> (number of
          faces). When they wrap the strip, the letters realign to form the message.
        </p>
      </div>
    </div>

    <div id="modal-challenge" class="modal hidden">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>Cryptography Challenge</h2>
        <p>Your commander has intercepted a Spartan messenger. The strip reads:</p>
        <div class="challenge-code">H_A_T_L_E_L_O</div>
        <!-- dynamic challenge -->
        <p id="challenge-text" class="challenge-text"></p>
        <p>Hint: We believe the rod used had <span id="challenge-hint-faces">?</span> faces.</p>
        <input type="text" id="challenge-input" placeholder="Decoded message...">
        <button id="btn-submit-challenge">Submit Decrypt</button>
        <div id="challenge-success" class="hidden">
          <h3>Correct!</h3>
          <p>You have proven your skills.</p>
          <button id="btn-download-cert">Download Certificate</button>
        </div>
      </div>
    </div>

  </div>
  <script type="module" src="/main.js"></script>
</body>

</html>